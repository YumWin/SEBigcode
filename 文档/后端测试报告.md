# 后端测试报告

## 目录

[TOC]

<br>

## 更新历史

| 修改人员 |   日期    |           修改原因            |  版本号   |
| :------: | :-------: | :---------------------------: | :-------: |
|   王博   | 2020.6.26 |       提交测试报告模板        | ver 1.0.0 |
|   王博   | 2020.6.27 | 完成模板1，2，3及单元测试用例 | ver 1.5.0 |
|   王博   | 2020.6.28 |       完成集成测试用例        | ver 2.0.0 |

<br>

## 名词释义

| 词汇名称  | 词汇含义                                                     | 备注                                                         |
| :-------: | ------------------------------------------------------------ | ------------------------------------------------------------ |
| GreenTrip | 字面意思“绿途”，谐音“旅途”，寓意着对客户在外旅行一路顺风的祝福 | 代指由来自南京大学软件学院的团队进行开发测试维护的一套涵盖酒店预订、房间信息维护、优惠策略等功能的酒店管理系统 |

<br>

## 1. 概述

### 1.1 编写目的

编写本测试方案的目的是为软件开发项目管理者、软件工程师、系统维护工程师、测试工程师提供关于GreenTrip酒店管理系统整体系统功能和性能的测试指导。

<br>

### 1.2 读者对象

本测试方案的合法读者对象为软件开发项目管理者、软件工程师、测试组、系统维护工程师。

<br>

### 1.3 项目背景

随着工作和生活节奏的加快，人们的差旅出行需要迅速提升，但是传统上的线下酒店预订模式有着很多不方便之处：

+ 因为目的地往往是外地，无法全面了解当地的酒店情况，选择范围大大受限， 难以选择到最适合的酒店；
+ 提前预订的双方都有风险，酒店担心恶意预订，顾客担心酒店不符合预期；
+ 酒店要及时掌握预订顾客的行程变化也会比较麻烦，需要频繁的长途联系；
+ 虽然过去的体验能够给未来带来参考，但是时间一长很多信息就会被遗忘掉，过去的参考作用就受到限制（事实上，过去的出行体验会大大影响人们未来的选择）。

为了解决上述问题，方便人们出行中的酒店预订，需要一个互联网酒店管理系统

<br>

### 1.4 测试目标

最终目标是确保软件的功能符合用户的需求，把尽可能多的问题在发布或交付之前发现并改正。

- 确保软件完成了它所承诺或公布的功能
- 确保软件满足了性能的要求
- 确保软件是健壮的和适应用户环境的
- 为软件的质量评估提供依据
- 为软件质量改进和管理提供帮助

<br>

### 1.5 参考资料

1. 《软件工程与计算（卷二）软件开发的技术基础》
2. 需求规格说明文档
3. 体系结构描述文档
4. 详细设计文档

<br>

## 2. 测试配套要求

### 2.1 网络环境

#### 2.1.1 网络硬件

详情参考具体环境配置

#### 2.1.2 网络软件

详情参考具体环境配置

<br>

### 2.2 服务器环境

#### 2.2.1 服务器硬件

详情参考具体环境配置

#### 2.2.2 服务器软件

详情参考具体环境配置

<br>

### 2.3 测试手段

基于黑盒测试和白盒测试的单元测试和集成测试

<br>

### 2.4 测试数据

以客户单位具体的业务规则和GreenTrip酒店管理系统《需求规格描述文档》，参考GreenTrip酒店管理系统《用例文档》、《体系结构描述文档》、《详细设计文档》中规定的运行限制，设计测试用例，作为整个GreenTrip酒店管理系统的测试数据

<br>

### 2.5 测试策略

测试过程按两个步骤进行，即单元测试、集成测试，根据不同阶段测试的侧重点不同，分别介绍测试策略。

+ 单元测试
  + 首先按照系统、子系统和模块进行划分，但最终的单元必须是功能模块，或面向对象过程中的若干个类。单元测试是对功能模块进行正确性检验的测试工作，也是后续测试的基础。目的是在于发现各模块内部可能存在的各种差错，因此需要从程序的内部结构出发设计测试用例，着重考虑以下五个方面：
    + 模块接口：对所测模块的数据流进行测试。
    + 局部数据结构：检查不正确或不一致的数据类型说明、使用尚未赋值或尚未初始化的变量、错误的初始值或缺省值。
    + 路径：虽然不可能做到穷举测试，但要设计测试用例查找由于不正确的计算（包括算法错、表达式的符号表示不正确、运算精度不够等）、不正确的比较或不正常的控制流（包括不同数据类型量的相互比较、不适当地修改了循环变量、错误的或不可能的循环终止条件等）而导致的错误。
    + 错误处理：检查模块有没有对预见错误的条件设计比较完善的错误处理功能，保证其逻辑上的正确性。
    + 边界：注意设计数据流、控制流中刚好等于、大于或小于确定的比较值的用例。

+ 集成测试
  + 集成测试也叫组装测试或联合测试。通常在单元测试的基础上需要将所有的模块按照设计要求组装成系统，下面是需要考虑的问题：
    + 在把各个模块连接起来的时候，穿越模块接口的数据是否会丢失。
    + 一个模块的功能是否会对另一个模块的功能产生不利的影响。
    + 各个子功能组合起来，能否达到预期要求的父功能。
    + 全局数据结构是否有问题。
    + 单元模块的误差累积起来，是否会放大，从而达到不能接受的程度。
    + 组装时参考采用一次性组装方式

<br>

### 2.6 测试通过准则

在此规定本系统通过测试的准则，即当依据测试用例执行者测试结果与预期结果相符，或测试结果与预期结果虽有不符但不可归咎于应用程序时为测试通过，反之则为测试失败

<br>

## 3. 单元测试用例

### 3.1 admin系统

#### 3.1.1 adminService子系统

##### 3.1.1.1 管理员注册模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：451ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addManager方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.1.1.2 管理员查看模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：10ms

**测试过程**：

第一步：模拟生成前端传来controller的指令

第二步：调用controller的getAllManagers方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("adminTest@qq.com",user.getEmail());
assertEquals("123456",user.getPassword());
assertEquals("2",user.getUserType().toString());
```

<br>

### 3.2 coupon系统

#### 3.2.1 couponService子系统

##### 3.2.1.1 添加满减优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：487ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addHotelTargetMoneyCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.2 添加满间优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addHotelTargetRoomCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.3 添加限时优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：9ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addHotelTimeCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.4 添加合作企业优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addCoopEnterpriseCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.5 添加生日优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addBirthdayCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.6 添加VIP优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：10ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addVipCoupon方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(judge);
```

<br>

##### 3.2.1.7 获取酒店所有优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：15ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的getHotelAllCoupons方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(6,count);
```

<br>

##### 3.2.1.8 获取符合优惠策略的优惠模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：37ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的getOrderMatchCoupons方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(5,count);
```

<br>

### 3.3 hotel系统

#### 3.3.1 hotelService子系统

##### 3.3.1.1 创建酒店模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：901ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的createHotel方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.3.1.2 搜索酒店模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：46ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的searchHotel方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO1.getSuccess());
List<HotelVO> hotellist=(List)hotelController.searchHotel("南京","XiDan").getContent();
HotelVO hotelVO=hotellist.get(hotellist.size()-1);
hotelId=hotelVO.getId();
assertEquals("南京市栖霞区珠江路163号",hotelVO.getAddress());
assertEquals("XiDan",hotelVO.getBizRegion());
assertEquals("欢迎您入住",hotelVO.getDescription());
assertEquals("Three",hotelVO.getHotelStar());
assertEquals(6,(int)hotelVO.getManagerId());
assertEquals("Stark",hotelVO.getName());
assertEquals(4.3,hotelVO.getRate(),0);
assertEquals("1829553719",hotelVO.getPhoneNum());
```

<br>

##### 3.3.1.3 更新酒店信息模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：15ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的updateHotelInfo方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("南京市栖霞区珠江路163号",hotel.getAddress());
assertEquals("XiDan",hotel.getBizRegion());
assertEquals("通过测试",hotel.getDescription());
assertEquals("Four",hotel.getHotelStar());
assertEquals(6,(int)hotel.getManagerId());
assertEquals("Stark",hotel.getName());
assertEquals(4.3,hotel.getRate(),0);
assertEquals("1829553719",hotel.getPhoneNum());
```

<br>

##### 3.3.1.4 删除酒店模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：60ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的deleteHotel方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("南京市栖霞区珠江路268号",hotel.getAddress());
assertEquals("XiDan",hotel.getBizRegion());
assertEquals("欢迎您入住",hotel.getDescription());
assertEquals("Four",hotel.getHotelStar());
assertEquals(6,(int)hotel.getManagerId());
assertEquals("桂圆酒店",hotel.getName());
assertEquals(4.8,hotel.getRate(),0);
assertEquals("1829553719",hotel.getPhoneNum());
```

<br>

#### 3.3.2 roomService子系统

##### 3.3.2.1 添加房间模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：445ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的addRoomInfo方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.3.2.2 获得酒店房间模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：11ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的retrieveHotelRoomInfo方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(25,hotelRoom.getCurNum());
assertEquals(30,hotelRoom.getTotal());
assertEquals(300,hotelRoom.getPrice(),0);
assertEquals("大床房",hotelRoom.getRoomType().toString());
```

<br>

##### 3.3.2.3 修改房间信息模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：9ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的modifyRoomInfo方法

第三步：通过controller的返回值判断是否调用成功

###### 预期输出

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.3.2.4 更新房间信息模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：9ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的updateRoomInfo方法

第三步：通过controller的返回值判断是否调用成功

###### 预期输出

```java
assertEquals(25,hotelRoom.getCurNum());
```

<br>

##### 3.3.2.5 更新房间数量模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：6ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的getRoomCurNum方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(25,roomService.getRoomCurNum(4,"BigBed"));
```

<br>

### 3.4 order系统

#### 3.4.1 orderService子系统

##### 3.4.1.1 创建订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：463ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的reserveHotel方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.4.1.2 获取所有订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的指令

第二步：调用controller的retrieveAllOrders方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已预订",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
```

<br>

##### 3.4.1.3 获取指定酒店订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：6ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的retrieveHotelOrders方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已预订",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
```

<br>

##### 3.4.1.4 获取指定用户订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：5ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的retrieveUserOrders方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已预订",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
```

<br>

##### 3.4.1.5 撤销订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：33ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的annulOrder方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
List<Order> OrderList=(List)orderController.retrieveAllOrders().getContent();
Order order=OrderList.get(0);
orderId=order.getId();
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已撤销",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
ResponseVO responseVO2=accountController.getUserInfo(1);
Double creditAfter=((User)(responseVO2.getContent())).getCredit();
assertEquals(30.0,creditBefore-creditAfter,0);
```

<br>

##### 3.4.1.6 修改订单状态模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：31ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的changeOrderState方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
List<Order> OrderList=(List)orderController.retrieveAllOrders().getContent();
Order order=OrderList.get(0);
orderId=order.getId();
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());
SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已执行",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
ResponseVO responseVO2=accountController.getUserInfo(1);
Double creditAfter=((User)(responseVO2.getContent())).getCredit();
assertEquals(300.0,creditAfter-creditBefore,0);
```

<br>

##### 3.4.1.7 删除订单模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的deleteOrder方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
List<Order> OrderList=(List)orderController.retrieveAllOrders().getContent();
assertEquals(0,OrderList.size());
```

<br>

##### 3.4.1.8 查看所有酒店模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：5ms

**测试过程**：

第一步：模拟生成前端传来controller的指令

第二步：调用controller的retrieveAllHotels方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(1,hotelVOList.size());
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.4.1.9 查看酒店详情模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：7ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的retrieveHotelDetail方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(2,hotelVO.getRooms().size());
```

<br>

### 3.5 user系统

#### 3.5.1 accountService子系统

##### 3.5.1.1 用户注册模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：475ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的registerAccount方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 3.5.1.2 用户登录模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：10ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的login方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(user.getEmail(),userForm.getEmail());
assertEquals(user.getPassword(),userForm.getPassword());
assertEquals(UserType.Client,user.getUserType());
assertEquals(100,user.getCredit(),0);
```

<br>

##### 3.5.1.3 获取用户信息模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：4ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的getUserInfo方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals("userTest@qq.com",user.getEmail());
assertEquals("123456",user.getPassword());
```

<br>

##### 3.5.1.4 更新用户信息模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：10ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的updateInfo方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
assertEquals("userTest@qq.com",user.getEmail());
assertEquals(userInfoVO.getPassword(),user.getPassword());
assertEquals(userInfoVO.getBirthday(),user.getBirthday());
assertEquals(userInfoVO.getEnterprise(),user.getEnterprise());
assertEquals(userInfoVO.getPhoneNumber(),user.getPhoneNumber());
assertEquals(userInfoVO.getUserName(),user.getUserName());
```

<br>

##### 3.5.1.5 获取用户VIP等级模块

**前提条件**：HotelApplication后端正常运行

**执行时间**：93ms

**测试过程**：

第一步：模拟生成前端传来controller的数据

第二步：调用controller的getUserLevel方法

第三步：通过controller的返回值判断是否调用成功

**预期输出**：

```java
assertEquals(1,responseVO.getContent());
```

<br>

## 4. 集成测试用例

### 4.1 子系统内部功能模块接口测试

#### 4.1.1 admin子系统内部功能模块之间的接口测试

##### 4.1.1.1 增加管理员，查询管理员模块间接口测试用例

**需求规格说明**：

增加管理员后管理员的基本信息被添加进数据库，可以通过查询管理员模块查询到

**测试用例**：

```java
@Test
public void AdminTest1(){
    UserForm userForm=new UserForm();
    userForm.setEmail("adminTest@qq.com");
    userForm.setPassword("123456");
    userForm.setUserType("2");
    ResponseVO responseVO=adminController.addManager(userForm);
    assertTrue(responseVO.getSuccess());
}

@Test
public void AdminTest2(){
    List adminList=((List)(adminController.getAllManagers().getContent()));
    User user=(User)adminList.get(adminList.size()-1);
    assertEquals("adminTest@qq.com",user.getEmail());
    assertEquals("123456",user.getPassword());
    assertEquals("2",user.getUserType().toString());
}
```

**预期输出**：

```java
assertEquals("adminTest@qq.com",user.getEmail());
assertEquals("123456",user.getPassword());
assertEquals("2",user.getUserType().toString());
```

<br>

#### 4.1.2 coupon子系统内部功能模块之间的接口测试

##### 4.1.2.1 增加优惠券，查询所有优惠券模块间接口测试用例

**需求规格说明**：

增加优惠券后优惠券的基本信息被添加进数据库，可以通过查询优惠券模块查询到

**测试用例**：

```java
@Test
public void CouponTest1() {

    boolean judge=true;
    HotelTargetMoneyCouponVO couponVO=new HotelTargetMoneyCouponVO();
    couponVO.setName("testTargetMoney");
    couponVO.setDescription("it's a TargetMoneyCoupon for test");
    couponVO.setType(3);
    couponVO.setTargetMoney(150);
    couponVO.setHotelId(1);
    couponVO.setDiscountMoney(100);
    couponVO.setDiscount(-1);
    ResponseVO responseVO=couponController.addHotelTargetMoneyCoupon(couponVO);
    if(!responseVO.getSuccess()){
        judge=false;
    }
    else{
        couponIdList.add(couponVO.getName());
    }
    assertTrue(judge);

}

@Test
public void CouponTest7() {
    ResponseVO responseVO=couponController.getHotelAllCoupons(1);
    List<Coupon> couponList=(List)responseVO.getContent();
    int count=0;
    List<Coupon> couponToBeDeleted=new ArrayList<>();
    for(int i=0;i<couponList.size();i++){
        if(couponIdList.indexOf(couponList.get(i).getCouponName())!=-1){
            count+=1;
            couponToBeDeleted.add(couponList.get(i));
        }
    }
    assertEquals(6,count);
}
```

**预期输出**：

```java
assertEquals(6,count);
```

<br>

##### 4.1.2.2 增加优惠券，查询符合条件优惠券模块间接口测试用例

**需求规格说明**：

增加优惠券后优惠券的基本信息被添加进数据库，可以通过查询符合条件优惠券模块查询到

**测试用例**：

```java
@Test
public void CouponTest1() {
    boolean judge = true;
    HotelTargetMoneyCouponVO couponVO = new HotelTargetMoneyCouponVO();
    couponVO.setName("testTargetMoney");
    couponVO.setDescription("it's a TargetMoneyCoupon for test");
    couponVO.setType(3);
    couponVO.setTargetMoney(150);
    couponVO.setHotelId(1);
    couponVO.setDiscountMoney(100);
    couponVO.setDiscount(-1);
    ResponseVO responseVO = couponController.addHotelTargetMoneyCoupon(couponVO);
    if(!responseVO.getSuccess()){
        judge=false;
    }
    else{
        couponIdList.add(couponVO.getName());
    }
    assertTrue(judge);

}

@Test
public void CouponTest8() {
    ResponseVO responseVO = couponController.getOrderMatchCoupons(1,1,300.0,2,"2020-01-19","2020-12-20");
    List<Coupon> couponList = (List)responseVO.getContent();
    int count = 0;
    List<Coupon> couponToBeDeleted = new ArrayList<>();
    for(int i=0;i<couponList.size();i++){
        if(couponIdList.indexOf(couponList.get(i).getCouponName())!=-1){
            count+=1;
            couponToBeDeleted.add(couponList.get(i));
        }
    }
    assertEquals(5,count);

    for(int i=0;i<couponToBeDeleted.size();i++){
        couponController.deleteCoupon(couponToBeDeleted.get(i).getHotelId(),couponToBeDeleted.get(i).getId());
    }
}
```

**预期输出**：

```java
assertEquals(5,count);
```

<br>

#### 4.1.3 hotel子系统内部功能模块之间的接口测试

##### 4.1.3.1 增加酒店，查询酒店模块间接口测试用例

**需求规格说明**：

增加酒店后酒店的基本信息被添加进数据库，可以通过查询酒店模块查询到

**测试用例**：

```java
@Test
public void HotelTest1(){
    HotelVO hotelVO = new HotelVO();
    hotelVO.setAddress("南京市栖霞区珠江路163号");
    hotelVO.setBizRegion("XiDan");
    hotelVO.setDescription("欢迎您入住");
    hotelVO.setHotelStar("Three");
    hotelVO.setManagerId(6);
    hotelVO.setName("Stark");
    hotelVO.setRate(4.3);
    hotelVO.setPhoneNum("1829553719");
    ResponseVO responseVO = new ResponseVO();
    try{
        responseVO = hotelController.createHotel(hotelVO);
        assertTrue(responseVO.getSuccess());
    }
    catch (Exception e){
        System.out.println(e.getMessage());
    }

}

@Test
public void HotelTest2(){
    try{
        ResponseVO responseVO = orderController.retrieveAllHotels();
        List<HotelVO> hotelVOList = (List)responseVO.getContent();
        assertEquals(2,hotelVOList.size());
        assertTrue(responseVO.getSuccess());
        hotelId = hotelVOList.get(hotelVOList.size()-1).getId();
        HotelRoom hotelRoom = new HotelRoom();
        hotelRoom.setWifi(1);
        hotelRoom.setPeopleNum(3);
        hotelRoom.setBreakfast(1);
        hotelRoom.setBedType("大床");
        hotelRoom.setRoomType(RoomType.BigBed);
        hotelRoom.setTotal(20);
        hotelRoom.setCurNum(20);
        hotelRoom.setPrice(300);
        hotelRoom.setHotelId(hotelId);
        ResponseVO responseVO1 = hotelController.addRoomInfo(hotelRoom);
        assertTrue(responseVO1.getSuccess());
        List<HotelVO> hotellist = (List)hotelController.searchHotel("南京","XiDan").getContent();
        HotelVO hotelVO = hotellist.get(hotellist.size()-1);
        hotelId = hotelVO.getId();
        assertEquals("南京市栖霞区珠江路163号",hotelVO.getAddress());
        assertEquals("XiDan",hotelVO.getBizRegion());
        assertEquals("欢迎您入住",hotelVO.getDescription());
        assertEquals("Three",hotelVO.getHotelStar());
        assertEquals(6,(int)hotelVO.getManagerId());
        assertEquals("Stark",hotelVO.getName());
        assertEquals(4.3,hotelVO.getRate(),0);
        assertEquals("1829553719",hotelVO.getPhoneNum());
    }
    catch (Exception e){
        System.out.println(e.getMessage());
    }
}
```

**预期输出**：

```java
assertEquals("南京市栖霞区珠江路163号",hotel.getAddress());
assertEquals("XiDan",hotel.getBizRegion());
assertEquals("通过测试",hotel.getDescription());
assertEquals("Four",hotel.getHotelStar());
assertEquals(6,(int)hotel.getManagerId());
assertEquals("Stark",hotel.getName());
assertEquals(4.3,hotel.getRate(),0);
assertEquals("1829553719",hotel.getPhoneNum());
```

<br>

##### 4.1.3.2 增加酒店，更新酒店信息模块间接口测试用例

**需求规格说明**：

增加酒店后酒店的基本信息被添加进数据库，可以通过更新酒店信息更新数据库

**测试用例**：

```java
@Test
public void HotelTest1(){
    HotelVO hotelVO = new HotelVO();
    hotelVO.setAddress("南京市栖霞区珠江路163号");
    hotelVO.setBizRegion("XiDan");
    hotelVO.setDescription("欢迎您入住");
    hotelVO.setHotelStar("Three");
    hotelVO.setManagerId(6);
    hotelVO.setName("Stark");
    hotelVO.setRate(4.3);
    hotelVO.setPhoneNum("1829553719");
    ResponseVO responseVO = new ResponseVO();
    try{
        responseVO = hotelController.createHotel(hotelVO);
        assertTrue(responseVO.getSuccess());
    }
    catch (Exception e){
        System.out.println(e.getMessage());
    }
}

@Test
public void HotelTest3(){
    HotelVO hotelVO = new HotelVO();
    hotelVO.setId(hotelId);
    hotelVO.setAddress("南京市栖霞区珠江路163号");
    hotelVO.setBizRegion("XiDan");
    hotelVO.setDescription("通过测试");
    hotelVO.setHotelStar("Four");
    hotelVO.setManagerId(6);
    hotelVO.setName("Stark");
    hotelVO.setRate(4.3);
    hotelVO.setPhoneNum("1829553719");
    ResponseVO responseVO = new ResponseVO();
    try{
        responseVO = hotelController.updateHotelInfo(hotelVO);
        List<HotelVO> hotelVOList = (List)hotelController.searchHotel("南京","XiDan").getContent();
        HotelVO hotel = hotelVOList.get(hotelVOList.size()-1);
        assertEquals("南京市栖霞区珠江路163号",hotel.getAddress());
        assertEquals("XiDan",hotel.getBizRegion());
        assertEquals("通过测试",hotel.getDescription());
        assertEquals("Four",hotel.getHotelStar());
        assertEquals(6,(int)hotel.getManagerId());
        assertEquals("Stark",hotel.getName());
        assertEquals(4.3,hotel.getRate(),0);
        assertEquals("1829553719",hotel.getPhoneNum());
    }
    catch (Exception e){
        System.out.println("Error");
    }
    assertTrue(responseVO.getSuccess());
}
```

**预期输出**：

```java
assertEquals("南京市栖霞区珠江路163号",hotel.getAddress());
assertEquals("XiDan",hotel.getBizRegion());
assertEquals("通过测试",hotel.getDescription());
assertEquals("Four",hotel.getHotelStar());
assertEquals(6,(int)hotel.getManagerId());
assertEquals("Stark",hotel.getName());
assertEquals(4.3,hotel.getRate(),0);
assertEquals("1829553719",hotel.getPhoneNum());
```

<br>

##### 4.1.3.3 增加酒店，删除酒店模块间接口测试用例

**需求规格说明**：

增加酒店后酒店的基本信息被添加进数据库，可以通过删除酒店模块更新数据库

**测试用例**：

```java
@Test
public void HotelTest1(){
    HotelVO hotelVO = new HotelVO();
    hotelVO.setAddress("南京市栖霞区珠江路163号");
    hotelVO.setBizRegion("XiDan");
    hotelVO.setDescription("欢迎您入住");
    hotelVO.setHotelStar("Three");
    hotelVO.setManagerId(6);
    hotelVO.setName("Stark");
    hotelVO.setRate(4.3);
    hotelVO.setPhoneNum("1829553719");
    ResponseVO responseVO = new ResponseVO();
    try{
        responseVO = hotelController.createHotel(hotelVO);
        assertTrue(responseVO.getSuccess());
    }
    catch (Exception e){
        System.out.println(e.getMessage());
    }
}

@Test
public void HotelTest4(){
    try{
        ResponseVO responseVO = hotelController.deleteHotel(hotelId);
        assertTrue(responseVO.getSuccess());
        List<HotelVO> hotelVOList = (List)hotelController.searchHotel("南京","XiDan").getContent();
        HotelVO hotel = hotelVOList.get(hotelVOList.size()-1);
        assertEquals("南京市栖霞区珠江路268号",hotel.getAddress());
        assertEquals("XiDan",hotel.getBizRegion());
        assertEquals("欢迎您入住",hotel.getDescription());
        assertEquals("Four",hotel.getHotelStar());
        assertEquals(6,(int)hotel.getManagerId());
        assertEquals("桂圆酒店",hotel.getName());
        assertEquals(4.8,hotel.getRate(),0);
        assertEquals("1829553719",hotel.getPhoneNum());
    }catch (Exception e){
        System.out.println("Error");
    }
}
```

**预期输出**：

```java
assertEquals("南京市栖霞区珠江路268号",hotel.getAddress());
assertEquals("XiDan",hotel.getBizRegion());
assertEquals("欢迎您入住",hotel.getDescription());
assertEquals("Four",hotel.getHotelStar());
assertEquals(6,(int)hotel.getManagerId());
assertEquals("桂圆酒店",hotel.getName());
assertEquals(4.8,hotel.getRate(),0);
assertEquals("1829553719",hotel.getPhoneNum());
```

<br>

#### 4.1.4 room子系统内部功能模块之间的接口测试

##### 4.1.4.1 增加房间，查询房间模块间接口测试用例

**需求规格说明**：

增加房间后房间的基本信息被添加进数据库，可以通过查询房间模块查询到

**测试用例**：

```java
@Test
public void RoomTest1(){
    HotelRoom hotelRoom = new HotelRoom();
    hotelRoom.setWifi(1);
    hotelRoom.setPeopleNum(3);
    hotelRoom.setBreakfast(1);
    hotelRoom.setBedType("大床");
    hotelRoom.setRoomType(RoomType.BigBed);
    hotelRoom.setTotal(20);
    hotelRoom.setCurNum(20);
    hotelRoom.setPrice(300);
    hotelRoom.setHotelId(4);
    ResponseVO responseVO = hotelController.addRoomInfo(hotelRoom);
    assertTrue(responseVO.getSuccess());
}
@Test
public void RoomTest2(){
    List<HotelRoom> roomList = roomService.retrieveHotelRoomInfo(4);
    HotelRoom hotelRoom = roomList.get(roomList.size()-1);
    roomId = hotelRoom.getId();
    assertEquals(25,hotelRoom.getCurNum());
    assertEquals(30,hotelRoom.getTotal());
    assertEquals(300,hotelRoom.getPrice(),0);
    assertEquals("大床房",hotelRoom.getRoomType().toString());
}
```

**预期输出**：

```java
assertEquals(25,hotelRoom.getCurNum());
assertEquals(30,hotelRoom.getTotal());
assertEquals(300,hotelRoom.getPrice(),0);
assertEquals("大床房",hotelRoom.getRoomType().toString());
```

<br>

##### 4.1.4.2 增加房间，修改房间信息模块间接口测试用例

**需求规格说明**：

增加房间后房间的基本信息被添加进数据库，可以通过修改房间模块修改数据库

**测试用例**：

```java
@Test
public void RoomTest1(){
    HotelRoom hotelRoom = new HotelRoom();
    hotelRoom.setWifi(1);
    hotelRoom.setPeopleNum(3);
    hotelRoom.setBreakfast(1);
    hotelRoom.setBedType("大床");
    hotelRoom.setRoomType(RoomType.BigBed);
    hotelRoom.setTotal(20);
    hotelRoom.setCurNum(20);
    hotelRoom.setPrice(300);
    hotelRoom.setHotelId(4);
    ResponseVO responseVO = hotelController.addRoomInfo(hotelRoom);
    assertTrue(responseVO.getSuccess());
}

@Test
public void RoomTest3(){
    RoomVO roomVO = new RoomVO();
    roomVO.setCurNum(30);
    roomVO.setId(roomId);
    roomVO.setPrice(200.0);
    roomVO.setRoomType("BigBed");
    roomVO.setTotal(30);
    roomVO.setBreakfast(1);
    roomVO.setBedType("大床");
    roomVO.setPeopleNum(2);
    roomVO.setWifi(1);
    ResponseVO responseVO = new ResponseVO();
    
    try{
        responseVO = hotelController.modifyRoomInfo(roomVO);}
    catch (Exception e){
        System.out.println("Error");
    }
    assertTrue(responseVO.getSuccess());
}
```

**预期输出**：

```java
assertTrue(responseVO.getSuccess());
```

<br>

##### 4.1.4.3 增加房间，更新房间信息模块间接口测试用例

**需求规格说明**：

增加房间后房间的基本信息被添加进数据库，可以通过更新房间模块更新数据库

**测试用例**：

```java
@Test
public void RoomTest1(){
    HotelRoom hotelRoom = new HotelRoom();
    hotelRoom.setWifi(1);
    hotelRoom.setPeopleNum(3);
    hotelRoom.setBreakfast(1);
    hotelRoom.setBedType("大床");
    hotelRoom.setRoomType(RoomType.BigBed);
    hotelRoom.setTotal(20);
    hotelRoom.setCurNum(20);
    hotelRoom.setPrice(300);
    hotelRoom.setHotelId(4);
    ResponseVO responseVO = hotelController.addRoomInfo(hotelRoom);
    assertTrue(responseVO.getSuccess());
}

@Test
public void RoomTest4(){
    roomService.updateRoomInfo(4,"BigBed",5);
    List<HotelRoom> roomList = roomService.retrieveHotelRoomInfo(4);
    HotelRoom hotelRoom = roomList.get(roomList.size()-1);
    assertEquals(25,hotelRoom.getCurNum());
}
```

**预期输出**：

```java
assertEquals(25,hotelRoom.getCurNum());
```

<br>

#### 4.1.5 order子系统内部功能模块之间的接口测试

##### 4.1.5.1 增加订单，查询订单信息模块间接口测试用例

**需求规格说明**：

增加订单后订单的基本信息被添加进数据库，可以通过查询订单模块查询到

**测试用例**：

```java
@Test
public void OrderTest1(){
    OrderVO orderVO = new OrderVO();
    orderVO.setCheckInDate("2020-08-23");
    orderVO.setCheckOutDate("2021-06-23");
    orderVO.setClientName("后端测试");
    orderVO.setHotelId(2);
    orderVO.setOrderState("已预订");
    orderVO.setPhoneNumber("18021852796");
    orderVO.setPrice(300.0);
    orderVO.setRoomNum(3);
    orderVO.setUserId(1);
    orderVO.setHaveChild(true);
    orderVO.setHotelName("桂圆酒店");
    orderVO.setPeopleNum(2);
    orderVO.setRoomType("BigBed");
    ResponseVO responseVO = orderController.reserveHotel(orderVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void OrderTest2(){
    List<Order> OrderList = (List)orderController.retrieveAllOrders().getContent();
    Order order = OrderList.get(0);
    orderId = order.getId();
    assertEquals("2020-08-23",order.getCheckInDate());
    assertEquals("2021-06-23",order.getCheckOutDate());
    
    SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
    Date date = new Date(System.currentTimeMillis());
    String curdate = sf.format(date);
    assertEquals(curdate,order.getCreateDate());
    assertEquals("后端测试",order.getClientName());
    assertEquals(2,(int)(order.getHotelId()));
    assertEquals("已预订",order.getOrderState());
    assertEquals("18021852796",order.getPhoneNumber());
    assertEquals(300.0,order.getPrice(),0);
    assertEquals(3,(int)order.getRoomNum());
    assertEquals(1,(int)order.getUserId());
    assertTrue(order.isHaveChild());
    assertEquals("桂圆酒店",order.getHotelName());
    assertEquals(2,(int)order.getPeopleNum());
    assertEquals("BigBed",order.getRoomType());
}
```

**预期输出**：

```java
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已预订",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());
```

<br>

##### 4.1.5.2 增加订单，删除订单信息模块间接口测试用例

**需求规格说明**：

增加订单后订单的基本信息被添加进数据库，可以通过删除订单模块将其从数据库移除

**测试用例**：

```java
@Test
public void OrderTest1(){
    OrderVO orderVO = new OrderVO();
    orderVO.setCheckInDate("2020-08-23");
    orderVO.setCheckOutDate("2021-06-23");
    orderVO.setClientName("后端测试");
    orderVO.setHotelId(2);
    orderVO.setOrderState("已预订");
    orderVO.setPhoneNumber("18021852796");
    orderVO.setPrice(300.0);
    orderVO.setRoomNum(3);
    orderVO.setUserId(1);
    orderVO.setHaveChild(true);
    orderVO.setHotelName("桂圆酒店");
    orderVO.setPeopleNum(2);
    orderVO.setRoomType("BigBed");
    ResponseVO responseVO = orderController.reserveHotel(orderVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void OrderTest7(){
    ResponseVO responseVO = orderController.deleteOrder(orderId);
    assertTrue(responseVO.getSuccess());
    List<Order> OrderList = (List)orderController.retrieveAllOrders().getContent();
    assertEquals(0,OrderList.size());
}
```

**预期输出**：

```java
assertEquals(0,OrderList.size());
```

<br>

#### 4.1.6 user子系统内部功能模块之间的接口测试

##### 4.1.6.1 注册用户，登录模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过登录模块登录网站

**测试用例**：

```java
@Test
public void AccountTest1(){
    UserVO userVO = new UserVO();
    userVO.setEmail("userTest@qq.com");
    userVO.setPassword("123456");
    userVO.setCredit(100);
    userVO.setUserType(UserType.Client);
    ResponseVO responseVO = accountController.registerAccount(userVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void AccountTest2(){
    UserForm userForm = new UserForm();
    userForm.setEmail("userTest@qq.com");
    userForm.setPassword("123456");
    ResponseVO responseVO = accountController.login(userForm);
    User user = (User)responseVO.getContent();
    assertEquals(user.getEmail(),userForm.getEmail());
    assertEquals(user.getPassword(),userForm.getPassword());
    assertEquals(UserType.Client,user.getUserType());
    assertEquals(100,user.getCredit(),0);
}
```

**预期输出**：

```java
assertEquals(user.getEmail(),userForm.getEmail());
assertEquals(user.getPassword(),userForm.getPassword());
assertEquals(UserType.Client,user.getUserType());
assertEquals(100,user.getCredit(),0);
```

<br>

##### 4.1.6.2 注册用户，获取用户信息模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过获取用户信息模块查询数据库

**测试用例**：

```java
@Test
public void AccountTest1(){
    UserVO userVO = new UserVO();
    userVO.setEmail("userTest@qq.com");
    userVO.setPassword("123456");
    userVO.setCredit(100);
    userVO.setUserType(UserType.Client);
    ResponseVO responseVO = accountController.registerAccount(userVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void AccountTest3(){
    User user = (User)accountController.getUserInfo(userId).getContent();
    assertEquals("userTest@qq.com",user.getEmail());
    assertEquals("123456",user.getPassword());
}
```

**预期输出**：

```java
assertEquals("userTest@qq.com",user.getEmail());
assertEquals("123456",user.getPassword());
```

<br>

##### 4.1.6.3 注册用户，更新用户信息模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过更新用户信息模块更新数据库

**测试用例**：

```java
@Test
public void AccountTest1(){
    UserVO userVO = new UserVO();
    userVO.setEmail("userTest@qq.com");
    userVO.setPassword("123456");
    userVO.setCredit(100);
    userVO.setUserType(UserType.Client);
    ResponseVO responseVO = accountController.registerAccount(userVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void AccountTest4(){
    UserInfoVO userInfoVO = new UserInfoVO();
    userInfoVO.setUserName("后端测试");
    userInfoVO.setVipLevel(1);
    userInfoVO.setEnterprise("南京大学");
    SimpleDateFormat df = new SimpleDateFormat("yyyyMMdd HH:mm:ss");
    String date = df.format(System.currentTimeMillis());
    String orderDate = date.substring(0,4)+"-"+date.substring(4,6)+"-"+date.substring(6,8);
    userInfoVO.setBirthday(orderDate);
    userInfoVO.setPassword("123456");
    userInfoVO.setPhoneNumber("18021852796");
    ResponseVO responseVO=accountController.updateInfo(userInfoVO,userId);
    assertTrue(responseVO.getSuccess());
    
    User user =(User)accountController.getUserInfo(userId).getContent();
    assertEquals("userTest@qq.com",user.getEmail());
    assertEquals(userInfoVO.getPassword(),user.getPassword());
    assertEquals(userInfoVO.getBirthday(),user.getBirthday());
    assertEquals(userInfoVO.getEnterprise(),user.getEnterprise());
    assertEquals(userInfoVO.getPhoneNumber(),user.getPhoneNumber());
    assertEquals(userInfoVO.getUserName(),user.getUserName());
}
```

**预期输出**：

```java
assertTrue(responseVO.getSuccess());

User user = (User)accountController.getUserInfo(userId).getContent();
assertEquals("userTest@qq.com",user.getEmail());
assertEquals(userInfoVO.getPassword(),user.getPassword());
assertEquals(userInfoVO.getBirthday(),user.getBirthday());
assertEquals(userInfoVO.getEnterprise(),user.getEnterprise());
assertEquals(userInfoVO.getPhoneNumber(),user.getPhoneNumber());
assertEquals(userInfoVO.getUserName(),user.getUserName());
```

<br>

##### 4.1.6.4 注册用户，获取用户VIP等级模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过获取用户VIP等级模块查询数据库

**测试用例**：

```java
@Test
public void AccountTest1(){
    UserVO userVO = new UserVO();
    userVO.setEmail("userTest@qq.com");
    userVO.setPassword("123456");
    userVO.setCredit(100);
    userVO.setUserType(UserType.Client);
    ResponseVO responseVO = accountController.registerAccount(userVO);
    assertTrue(responseVO.getSuccess());
}

@Test
public void AccountTest5(){
    accountController.updateUserLevel(userId);
    ResponseVO responseVO = accountController.getUserLevel(userId);
    assertEquals(1,responseVO.getContent());
    accountController.creditCharge("{\"creditChargeUserID\":\"123\",\"chargeMoney\":\"50\",\"relatedInformation\":\"\"}");
}
```

###### 预期输出

```java
assertEquals(1,responseVO.getContent());
```

<br>

### 4.2  子系统之间接口测试

#### 4.2.1 user，order子系统功能模块之间的接口测试

##### 4.2.1.1 获取用户信息，获取用户订单模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过获取用户信息模块查询用户订单

**测试用例**：

```java
@Test
public void OrderTest5(){
    ResponseVO responseVO1 = accountController.getUserInfo(1);
    Double creditBefore = ((User)(responseVO1.getContent())).getCredit();
    ResponseVO responseVO = orderController.annulOrder(orderId);
    assertTrue(responseVO.getSuccess());
    
    List<Order> OrderList = (List)orderController.retrieveAllOrders().getContent();
    Order order = OrderList.get(0);
    orderId = order.getId();
    assertEquals("2020-08-23",order.getCheckInDate());
    assertEquals("2021-06-23",order.getCheckOutDate());
    
    SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
    Date date = new Date(System.currentTimeMillis());
    String curdate = sf.format(date);
    assertEquals(curdate,order.getCreateDate());
    assertEquals("后端测试",order.getClientName());
    assertEquals(2,(int)(order.getHotelId()));
    assertEquals("已撤销",order.getOrderState());
    assertEquals("18021852796",order.getPhoneNumber());
    assertEquals(300.0,order.getPrice(),0);
    assertEquals(3,(int)order.getRoomNum());
    assertEquals(1,(int)order.getUserId());
    assertTrue(order.isHaveChild());
    assertEquals("桂圆酒店",order.getHotelName());
    assertEquals(2,(int)order.getPeopleNum());
    assertEquals("BigBed",order.getRoomType());
    
    ResponseVO responseVO2 = accountController.getUserInfo(1);
    Double creditAfter = ((User)(responseVO2.getContent())).getCredit();
    assertEquals(30.0,creditBefore-creditAfter,0);
}
```

**预期输出**：

```java
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());

SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);

assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已执行",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());

ResponseVO responseVO2 = accountController.getUserInfo(1);
Double creditAfter = ((User)(responseVO2.getContent())).getCredit();
assertEquals(300.0,creditAfter-creditBefore,0);
```

<br>

##### 4.2.1.2 获取用户信息，修改订单状态模块间接口测试用例

**需求规格说明**：

注册用户后用户的基本信息被添加进数据库，可以通过修改订单状态模块更改用户信用值

**测试用例**：

```java
@Test
public void OrderTest6(){
    ResponseVO responseVO1 = accountController.getUserInfo(1);
    Double creditBefore = ((User)(responseVO1.getContent())).getCredit();
    ResponseVO responseVO = orderController.changeOrderState("已执行",orderId);
    assertTrue(responseVO.getSuccess());
     
    List<Order> OrderList = (List)orderController.retrieveAllOrders().getContent();
    Order order = OrderList.get(0);
    orderId = order.getId();
    assertEquals("2020-08-23",order.getCheckInDate());
    assertEquals("2021-06-23",order.getCheckOutDate());
    
    SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
    Date date = new Date(System.currentTimeMillis());
    String curdate = sf.format(date);
    assertEquals(curdate,order.getCreateDate());
    assertEquals("后端测试",order.getClientName());
    assertEquals(2,(int)(order.getHotelId()));
    assertEquals("已执行",order.getOrderState());
    assertEquals("18021852796",order.getPhoneNumber());
    assertEquals(300.0,order.getPrice(),0);
    assertEquals(3,(int)order.getRoomNum());
    assertEquals(1,(int)order.getUserId());
    assertTrue(order.isHaveChild());
    assertEquals("桂圆酒店",order.getHotelName());
    assertEquals(2,(int)order.getPeopleNum());
    assertEquals("BigBed",order.getRoomType());
    
    ResponseVO responseVO2 = accountController.getUserInfo(1);
    Double creditAfter = ((User)(responseVO2.getContent())).getCredit();
    assertEquals(300.0,creditAfter-creditBefore,0);
}
```

**预期输出**：

```java
assertEquals("2020-08-23",order.getCheckInDate());
assertEquals("2021-06-23",order.getCheckOutDate());

SimpleDateFormat sf = new SimpleDateFormat("yyyy-MM-dd");
Date date = new Date(System.currentTimeMillis());
String curdate = sf.format(date);
assertEquals(curdate,order.getCreateDate());
assertEquals("后端测试",order.getClientName());
assertEquals(2,(int)(order.getHotelId()));
assertEquals("已执行",order.getOrderState());
assertEquals("18021852796",order.getPhoneNumber());
assertEquals(300.0,order.getPrice(),0);
assertEquals(3,(int)order.getRoomNum());
assertEquals(1,(int)order.getUserId());
assertTrue(order.isHaveChild());
assertEquals("桂圆酒店",order.getHotelName());
assertEquals(2,(int)order.getPeopleNum());
assertEquals("BigBed",order.getRoomType());

ResponseVO responseVO2=accountController.getUserInfo(1);
Double creditAfter=((User)(responseVO2.getContent())).getCredit();
assertEquals(300.0,creditAfter-creditBefore,0);
```

<br>

#### 4.2.2 hotel，order子系统功能模块之间的接口测试

##### 4.2.2.1 获取酒店列表，添加房间信息模块间接口测试用例

**需求规格说明**：

新建酒店后酒店的基本信息被添加进数据库，可以通过添加房间信息模块更新数据库

**测试用例**：

```java
@Test
public void HotelTest2(){
    try{
        ResponseVO responseVO = orderController.retrieveAllHotels();
        List<HotelVO> hotelVOList = (List)responseVO.getContent();
        assertEquals(2,hotelVOList.size());
        assertTrue(responseVO.getSuccess());
        
        hotelId = hotelVOList.get(hotelVOList.size()-1).getId();
        HotelRoom hotelRoom = new HotelRoom();
        hotelRoom.setWifi(1);
        hotelRoom.setPeopleNum(3);
        hotelRoom.setBreakfast(1);
        hotelRoom.setBedType("大床");
        hotelRoom.setRoomType(RoomType.BigBed);
        hotelRoom.setTotal(20);
        hotelRoom.setCurNum(20);
        hotelRoom.setPrice(300);
        hotelRoom.setHotelId(hotelId);
        ResponseVO responseVO1 = hotelController.addRoomInfo(hotelRoom);
        assertTrue(responseVO1.getSuccess());
        
        List<HotelVO> hotellist = (List)hotelController.searchHotel("南京","XiDan").getContent();
        HotelVO hotelVO = hotellist.get(hotellist.size()-1);
        hotelId = hotelVO.getId();
        assertEquals("南京市栖霞区珠江路163号",hotelVO.getAddress());
        assertEquals("XiDan",hotelVO.getBizRegion());
        assertEquals("欢迎您入住",hotelVO.getDescription());
        assertEquals("Three",hotelVO.getHotelStar());
        assertEquals(6,(int)hotelVO.getManagerId());
        assertEquals("Stark",hotelVO.getName());
        assertEquals(4.3,hotelVO.getRate(),0);
        assertEquals("1829553719",hotelVO.getPhoneNum());
    }
    catch (Exception e){
        System.out.println(e.getMessage());
    }
}
```

**预期输出**：

```java
assertTrue(responseVO1.getSuccess());

List<HotelVO> hotellist=(List)hotelController.searchHotel("南京","XiDan").getContent();
HotelVO hotelVO=hotellist.get(hotellist.size()-1);
hotelId=hotelVO.getId();

assertEquals("南京市栖霞区珠江路163号",hotelVO.getAddress());
assertEquals("XiDan",hotelVO.getBizRegion());
assertEquals("欢迎您入住",hotelVO.getDescription());
assertEquals("Three",hotelVO.getHotelStar());
assertEquals(6,(int)hotelVO.getManagerId());
assertEquals("Stark",hotelVO.getName());
assertEquals(4.3,hotelVO.getRate(),0);
assertEquals("1829553719",hotelVO.getPhoneNum());
```

<br>

## 5. 附录